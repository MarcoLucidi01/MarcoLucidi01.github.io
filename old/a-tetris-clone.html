<!DOCTYPE html>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta charset="utf-8">
<link rel="stylesheet" href="../style.css">
<title>a tetris clone</title>

<h1>a tetris clone</h1>
<p>This is my first """big""" project in C, made after reading the bible
<a href="https://en.wikipedia.org/wiki/The_C_Programming_Language">K&amp;R Second Edition</a>
and after taking the Harvard course <a href="https://cs50.harvard.edu/">CS50</a>.

<p>Actually I consider this as my "final project" for CS50: I enjoy C so much that
I had to choose it as the main tool for the project.

<p>Here a <a href="https://www.youtube.com/watch?v=HRttr5_LnvI">demo video</a>
and here the <a href="https://github.com/MarcoLucidi01/tetris_clone"><strong>source code</strong></a>.

<h2>why tetris?</h2>
<p>Well, first because I like it: I used to play <strong>A LOT</strong> when I
was a kid on a "chinese fake GameBoy" I had and more recently on my smartphone.
And then because I wanted to do something simple within my reach, but at the same
time a bit challenging, considering the language I chose.

<p>Also it is often considered as an "Hello, World!" to game development so once in
my life I had to do it.

<h2>the game</h2>
<p>I tried to stick with the classic <em>Tetris</em>, so no "wall kick", no
"hold piece", no "ghost piece", but I applied some "new" features that I like:
"soft drop" (without adding points) and this
<a href="http://tetris.wikia.com/wiki/Random_Generator">random generator</a> so
that I don't have to swear to get an <em>I</em>.

<p>Keys to control what's on the screen are straightforward:
<ul>
<li><strong>LEFT / DOWN / UP / RIGHT</strong> performs classical movements;
<li><strong>H / J / K / L</strong> also performs classical movements. Did you
recognize them? They are those of <a href="http://www.vim.org/">Vim</a>! I'm a
Vim addicted and I thought it would be nice if I could use Vim keys to play Tetris =).
<li><strong>SPACE</strong> performs "hard drop".
<li><strong>P</strong> pause or unpause the game.
<li><strong>E</strong> ends the game when it is paused.
<li><strong>N</strong> starts a new game when the previous is over.
<li><strong>Q</strong> close the program when the game is over.
</ul>

<p>After the end of each game, it saves the level, score and lines along with the
current date and the time spent playing (including pause time) in a text file
called "scores.txt" within the folder in which the executable resides.

<p>For now, there isn't a way to add a nickname (because you know, probably I will
be the only player...).

<h2>the program</h2>
<p>If you haven't notice yet, I used the <a href="https://en.wikipedia.org/wiki/Ncurses">ncurses</a> library.

<p>Two "design choices" I made (I know I probably screw up somewhere) were: write
"reusable" code (in part) and split different things in different files.

<p>Here the files tree and a bit of explanation:
<pre>
project/
        Makefile
        include/
                actions.h
                colors.h
                controller.h
                drawer.h
                game.h
                grid.h
                helpers.h
                tetramino.h
        src/
                controller.c
                drawer.c
                game.c
                grid.c
                helpers.c
                main.c
                tetramino.c
</pre>

<p>For the first time in my three months adventure with C, I felt the need to use a
<a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/Makefile"><code>Makefile</code></a>
and it turned out to be veeery useful of course.

<p>In <a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/src/helpers.c"><code>helpers.c</code></a>
there are some helpers functions (youdontsay.jpg). There is for example a
"<code>malloc</code> wrapper" who calls <code>exit(EXIT_FAILURE)</code> if it was
not possible allocate memory. I call it (the wrapper) every time I need memory.

<p><a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/src/grid.c"><code>grid.c</code></a>
contains functions to handle guess what? Right, the game grid on which put blocks.

<p><a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/include/actions.h"><code>actions.h</code></a>
contains an enum of "actions" i.e. commands that modify the current state of the
game. I think their names are self-explanatory.

<p>The "magic" happens in the files <a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/src/main.c"><code>main.c</code></a>
and <a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/src/game.c"><code>game.c</code></a>:
they handle the game flow.

<p><a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/src/tetramino.c"><code>tetramino.c</code></a>
defines all you need to create a <a href="https://en.wikipedia.org/wiki/Tetromino"><code>tetramino</code></a>
rotate or change its shape and blindly put / remove it on / from a grid if it is
not locked.

<p>With <a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/src/controller.c"><code>controller.c</code></a>
instead, you can perform "actions" on a tetramino only if that action is allowed,
depending on the current state of the grid.

<p>That is, to move, rotate or drop a piece, <code>game.c</code> relies on the
functions in <code>controller.c</code> who relies on the "raw" functions in
<code>tetramino.c</code> after some tests.

<p><a href="https://github.com/MarcoLucidi01/tetris_clone/blob/master/src/drawer.c"><code>drawer.c</code></a>
takes care of the "ncurses part" drawing the grid, the edges and some informations.
It has a function, <code>refresh_scene()</code>, which is called in <code>game.c</code>
to update what is on the screen when it's time to do so.

<p><code>grid.c</code> and even <code>drawer.c</code> could be easily reused in
other projects, e.g. in a snake clone, tic-tac-toe, ..., basically anything who
requires a simple grid, because I made them "not Tetris specific".

<p>I tried to keep things as simple as possible (I always try to do this). For
example, I hard coded all possible rotations for each piece in <code>tetramino.c</code>
since in total they are only <em>4 x 7 = 28</em>. In this way I don't have to call a
function to rotate a matrix and sometimes rotate it backwards, but my functions
simply increment or decrement an index in range <em>[0,3]</em>. Of course I did this
because the amount of memory used is very low.

<h2>conclusion</h2>
<p>At the end of the day, the main goals of this project were:
<ul>
<li>learn something new;
<li>get a "working" Tetris clone;
<li>get my feet wet with ncurses;
<li>have some fun.
</ul>

<p>And I guess I've achieved them all. Even if it was not a big deal, it was my
first time with many things: a multiple files program (in C), a Makefile,
ncurses and small "tricks" I used in the code.

<p>So it was worth it!

<p>Thank you for reading up to here, if you have any comment / suggestion or if you
found a bug, please contact me via email. Bye.

<footer><a href="../index.html">index</a></footer>
